#############################################################################
## 数据源配置
#############################################################################
#企业数据源#
source rc_enterprise
{
    type                 = mysql
    sql_host             = 15.3.2.3
    sql_user             = root
    sql_pass             = dell_456
    sql_db               = com_vsochina_maker
    sql_port             = 3306
    sql_query_pre        = SET NAMES utf8
    sql_query_pre = REPLACE INTO tb_rc_sphinx_index_tmp SELECT 1, MAX(id) FROM tb_crm_company
    sql_query            = SELECT \
                            tem.*,\
                            tcc.name,\
                            tcc.logo,\
                            tcc.banner,\
                            tcc.contact_name,\
                            tcc.contact_postion,\
                            tcc.contact_wechat,\
                            tcc.contact_email,\
                            tcc.description,\
                            tcc.site_url,\
                            tcc.uptime,\
                            tcc.upuser,\
                            tcc.upusername,\
                            tcc.scoreArr,\
                            tcc.scoreNotArr,\
                            tcc.score_basic,\
                            tcc.score_status,\
                            tcc.reg_money,\
                            tcc.reg_time,\
                            tcc.nature,\
                            tcc.aptitude,\
                            tcc.turnover,\
                            tcc.output,\
                            tcc.has_original,\
                            tcc.is_render,\
                            tcc.has_develop,\
                            tcc.has_prize,\
                            tcc.update_time,\
                            tcc.indus_pid, \
                            tcc.indus_id, \
                            tcc.company_id, \
			    tcc.residency, \
                            tcc.residency_name,\
                          FROM\
                            (SELECT \
                              tu.uid,\
                              tu.username,\
                              tu.user_type,\
                              tu.status,\
                              tu.nickname,\
                              tu.truename,\
                              IFNULL(\
                                tu.avatar,\
                                'http://www.vsochina.com//data/avatar/default/man_middle.jpg'\
                              ) AS avatar,\
                              tu.mobile,\
                              tu.email,\
                              tu.id_card,\
                              tu.qq,\
                              tu.tag,\
                              tu.reg_type,\
                              tu.reg_ip,\
                              tu.created_at,\
                              tu.updated_at,\
                              tu.last_login_time,\
                              tu.login_times,\
                              tu.role_id,\
                              tu.work_img,\
                              tu.work_img_alt,\
                              tu.is_index,\
                              tu.listorder,\
                              tu.extend,\
                              IFNULL(kws.focus_num, 0) AS focus_num,\
                              (SELECT \
                                COUNT(work_id) \
                              FROM\
                                keke_witkey_utf8.keke_works_show \
                              WHERE deleted = 0 \
                                AND username = tu.username) AS work_count \
                            FROM\
                              com_vsochina_maker.tb_user AS tu \
                              LEFT JOIN keke_witkey_utf8.keke_witkey_space AS kws \
                                ON tu.username = kws.username \
                            WHERE tu.user_type = 2 \
                              AND tu.status = 1) AS tem \
                            LEFT JOIN \
                              (SELECT \
                                (SELECT \
                                GROUP_CONCAT(ptype) \
                              FROM\
                                com_vsochina_maker.tb_crm_industries \
                              WHERE \
                                company_id = tc.id) AS indus_pid, \
                              (SELECT \
                                GROUP_CONCAT(stype) \
                              FROM\
                                com_vsochina_maker.tb_crm_industries \
                              WHERE \
                                company_id = tc.id) AS indus_id, \
                                tc.*,\
                                tc.id AS company_id,\
				CRC32(tcity.name) AS residency, \
                                tcity.name AS residency_name \
                              FROM\
                                com_vsochina_maker.tb_crm_company AS tc \
				LEFT JOIN \
				  com_vsochina_maker.tb_city AS tcity \
				  ON tc.province = tcity.id \
				  ) AS tcc \
                              ON tem.username = tcc.username \
                            WHERE company_id<=(SELECT max_user_id FROM com_vsochina_maker.tb_rc_sphinx_index_tmp WHERE counter_id=1 )

    sql_attr_uint        = uid
    sql_field_string     = username
    sql_field_string     = user_type
    sql_field_string     = status
    sql_field_string     = nickname
    sql_field_string     = truename
    sql_field_string     = avatar
    sql_field_string     = mobile
    sql_field_string     = email
    sql_field_string     = id_card
    sql_field_string     = qq
    sql_field_string     = tag
    sql_field_string     = reg_type
    sql_field_string     = reg_ip
    sql_field_string     = created_at
    sql_field_string     = updated_at
    sql_field_string     = last_login_time
    sql_field_string     = login_times
    sql_field_string     = role_id
    sql_field_string     = work_img
    sql_field_string     = work_img_alt
    sql_field_string     = is_index
    sql_field_string     = listorder
    sql_field_string     = extend
    sql_attr_uint        = focus_num
    sql_attr_uint        = work_count
    sql_field_string     = name
    sql_field_string     = logo
    sql_field_string     = banner
    sql_field_string     = contact_name
    sql_field_string     = contact_postion
    sql_field_string     = contact_wechat
    sql_field_string     = contact_email
    sql_field_string     = description
    sql_field_string     = site_url
    sql_field_string     = uptime
    sql_field_string     = upuser
    sql_field_string     = upusername
    sql_field_string     = scoreArr
    sql_field_string     = scoreNotArr
    sql_field_string     = score_basic
    sql_field_string     = score_status
    sql_attr_uint        = reg_money
    sql_field_string     = reg_time
    sql_field_string     = nature
    sql_field_string     = aptitude
    sql_field_string     = turnover
    sql_field_string     = output
    sql_attr_uint        = has_original
    sql_attr_uint        = is_render
    sql_attr_uint        = has_develop
    sql_attr_uint        = has_prize
    sql_field_string     = update_time
    sql_attr_multi        = uint indus_pid from field
    sql_attr_multi        = uint indus_id from field
    sql_attr_uint         = residency
    sql_attr_uint        = company_id
    sql_field_string     = residency_name


    #sql_field_string...#
    sql_ranged_throttle  = 0
}
#增量企业数据源#
source rc_delta_enterprise:rc_enterprise
{
    sql_query_pre        = SET NAMES utf8
    sql_query_post = REPLACE INTO tb_rc_sphinx_index_tmp SELECT 1, MAX(id) FROM tb_crm_company
    sql_query            = SELECT \
                            tem.*,\
                            tcc.name,\
                            tcc.logo,\
                            tcc.banner,\
                            tcc.contact_name,\
                            tcc.contact_postion,\
                            tcc.contact_wechat,\
                            tcc.contact_email,\
                            tcc.description,\
                            tcc.site_url,\
                            tcc.uptime,\
                            tcc.upuser,\
                            tcc.upusername,\
                            tcc.scoreArr,\
                            tcc.scoreNotArr,\
                            tcc.score_basic,\
                            tcc.score_status,\
                            tcc.reg_money,\
                            tcc.reg_time,\
                            tcc.nature,\
                            tcc.aptitude,\
                            tcc.turnover,\
                            tcc.output,\
                            tcc.has_original,\
                            tcc.is_render,\
                            tcc.has_develop,\
                            tcc.has_prize,\
                            tcc.update_time,\
                            tcc.indus_pid, \
                            tcc.indus_id, \
                            tcc.company_id, \
			    tcc.residency, \
                            tcc.residency_name\
                          FROM\
                            (SELECT \
                              tu.uid,\
                              tu.username,\
                              tu.user_type,\
                              tu.status,\
                              tu.nickname,\
                              tu.truename,\
                              IFNULL(\
                                tu.avatar,\
                                'http://www.vsochina.com//data/avatar/default/man_middle.jpg'\
                              ) AS avatar,\
                              tu.mobile,\
                              tu.email,\
                              tu.id_card,\
                              tu.qq,\
                              tu.tag,\
                              tu.reg_type,\
                              tu.reg_ip,\
                              tu.created_at,\
                              tu.updated_at,\
                              tu.last_login_time,\
                              tu.login_times,\
                              tu.role_id,\
                              tu.work_img,\
                              tu.work_img_alt,\
                              tu.is_index,\
                              tu.listorder,\
                              tu.extend,\
                              IFNULL(kws.focus_num, 0) AS focus_num,\
                              (SELECT \
                                COUNT(work_id) \
                              FROM\
                                keke_witkey_utf8.keke_works_show \
                              WHERE deleted = 0 \
                                AND username = tu.username) AS work_count \
                            FROM\
                              com_vsochina_maker.tb_user AS tu \
                              LEFT JOIN keke_witkey_utf8.keke_witkey_space AS kws \
                                ON tu.username = kws.username \
                            WHERE tu.user_type = 2 \
                              AND tu.status = 1) AS tem \
                            LEFT JOIN \
                              (SELECT \
                                (SELECT \
                                GROUP_CONCAT(ptype) \
                              FROM\
                                com_vsochina_maker.tb_crm_industries \
                              WHERE \
                                company_id = tc.id) AS indus_pid, \
                              (SELECT \
                                GROUP_CONCAT(stype) \
                              FROM\
                                com_vsochina_maker.tb_crm_industries \
                              WHERE \
                                company_id = tc.id) AS indus_id, \
                                tc.*,\
                                tc.id AS company_id,\
				CRC32(tcity.name) AS residency, \
                                tcity.name AS residency_name \
                              FROM\
                                com_vsochina_maker.tb_crm_company AS tc \
				LEFT JOIN \
				  com_vsochina_maker.tb_city AS tcity \
				  ON tc.province = tcity.id \
				  ) AS tcc \
                              ON tem.username = tcc.username \
                            WHERE company_id>(SELECT max_user_id FROM com_vsochina_maker.tb_rc_sphinx_index_tmp WHERE counter_id=1 )

    sql_attr_uint        = uid
    sql_field_string     = username
    sql_field_string     = user_type
    sql_field_string     = status
    sql_field_string     = nickname
    sql_field_string     = truename
    sql_field_string     = avatar
    sql_field_string     = mobile
    sql_field_string     = email
    sql_field_string     = id_card
    sql_field_string     = qq
    sql_field_string     = tag
    sql_field_string     = reg_type
    sql_field_string     = reg_ip
    sql_field_string     = created_at
    sql_field_string     = updated_at
    sql_field_string     = last_login_time
    sql_field_string     = login_times
    sql_field_string     = role_id
    sql_field_string     = work_img
    sql_field_string     = work_img_alt
    sql_field_string     = is_index
    sql_field_string     = listorder
    sql_field_string     = extend
    sql_attr_uint        = focus_num
    sql_attr_uint        = work_count
    sql_field_string     = name
    sql_field_string     = logo
    sql_field_string     = banner
    sql_field_string     = contact_name
    sql_field_string     = contact_postion
    sql_field_string     = contact_wechat
    sql_field_string     = contact_email
    sql_field_string     = description
    sql_field_string     = site_url
    sql_field_string     = uptime
    sql_field_string     = upuser
    sql_field_string     = upusername
    sql_field_string     = scoreArr
    sql_field_string     = scoreNotArr
    sql_field_string     = score_basic
    sql_field_string     = score_status
    sql_attr_uint        = reg_money
    sql_field_string     = reg_time
    sql_field_string     = nature
    sql_field_string     = aptitude
    sql_field_string     = turnover
    sql_field_string     = output
    sql_attr_uint        = has_original
    sql_attr_uint        = is_render
    sql_attr_uint        = has_develop
    sql_attr_uint        = has_prize
    sql_field_string     = update_time
    sql_attr_multi        = uint indus_pid from field
    sql_attr_multi        = uint indus_id from field
    sql_attr_uint         = residency
    sql_attr_uint        = company_id
    sql_field_string     =residency_name


    #sql_field_string...#
    sql_ranged_throttle  = 0
}
#非企业数据源#
source rc_not_enterprise
{
    type                 = mysql
    sql_host             = 15.3.2.3
    sql_user             = root
    sql_pass             = dell_456
    sql_db               = com_vsochina_maker
    sql_port             = 3306
    sql_query_pre        = SET NAMES utf8
    sql_query_pre = REPLACE INTO tb_rc_sphinx_index_tmp SELECT 2, MAX(uid) FROM keke_witkey_utf8.keke_witkey_space
    sql_query            = SELECT \
                              tem.*,\
                              (tem.focus_num + work_count) AS score,\
                              IF(\
                                LENGTH(IFNULL(tem.sex, '保密')) < 1,\
                                '保密',\
                                IFNULL(tem.sex, '保密')\
                              ) AS sexstr \
                            FROM\
                              (SELECT \
                                kws.uid,\
                                kws.username,\
                                kws.email,\
                                kws.user_pic,\
                                kws.group_id,\
                                kws.isvip,\
                                kws.status,\
                                kws.user_type,\
                                kws.sex,\
                                CRC32(kws.residency) as residency,\
                                kws.residency as residency_name,\
                                kws.birthday,\
                                kws.truename,\
                                kws.idcard,\
                                kws.idpic,\
                                kws.qq,\
                                kws.msn,\
                                kws.fax,\
                                kws.phone,\
                                kws.mobile,\
                                kws.indus_id,\
                                kws.indus_pid,\
                                kws.skill_ids,\
                                kws.summary,\
                                kws.reg_time,\
                                kws.reg_ip,\
                                kws.credit,\
                                kws.balance,\
                                kws.pub_num,\
                                kws.take_num,\
                                kws.nominate_num,\
                                kws.accepted_num,\
                                kws.vip_start_time,\
                                kws.nickname,\
                                kws.real_name AS realname,\
                                kws.focus_num,\
                                kws.username AS `name`,\
                                (SELECT \
                                  COUNT(work_id) \
                                FROM\
                                  keke_witkey_utf8.keke_works_show AS kwsh \
                                WHERE kwsh.username = kws.username AND kwsh.deleted=0) AS work_count,\
                                (SELECT \
                                  id_card \
                                FROM\
                                  vsoucenter.vso_user_auth_realname AS vuar \
                                WHERE vuar.username = kws.username) AS identity,\
                                (SELECT \
                                  IFNULL(signture, '') \
                                FROM\
                                  keke_witkey_utf8.keke_witkey_signture AS kwsi \
                                WHERE kwsi.username = kws.username) AS signture,\
                                IFNULL(\
                                  tu.avatar,\
                                  'http://www.vsochina.com//data/avatar/default/man_middle.jpg'\
                                ) AS avatar,\
                                tu.tag \
                              FROM\
                                keke_witkey_utf8.keke_witkey_space AS kws \
                                LEFT JOIN com_vsochina_maker.tb_user AS tu \
                                  ON kws.username = tu.username \
                              WHERE kws.user_type <> 2 AND kws.pre_type <> 2) AS tem \
                              WHERE uid<=(SELECT max_user_id FROM com_vsochina_maker.tb_rc_sphinx_index_tmp WHERE counter_id=2 )
    sql_attr_uint        = uid
    sql_field_string     = username
    sql_field_string     = user_type
    sql_field_string     = email
    sql_field_string     = user_pic
    sql_field_string     = group_id
    sql_field_string     = isvip
    sql_attr_uint        = status
    sql_field_string     = sex
    sql_attr_uint         = residency
    sql_field_string     = birthday
    sql_field_string     = truename
    sql_field_string     = idcard
    sql_field_string     = idpic
    sql_field_string     = qq
    sql_field_string     = msn
    sql_field_string     = fax
    sql_field_string     = phone
    sql_field_string     = mobile
    sql_attr_multi        = uint indus_id from field
    sql_attr_multi        = uint indus_pid from field
    sql_field_string     = skill_ids
    sql_field_string     = summary
    sql_attr_timestamp   = reg_time
    sql_field_string     = reg_ip
    sql_attr_uint        = credit
    sql_field_string     = balance
    sql_attr_uint        = pub_num
    sql_attr_uint        = take_num
    sql_attr_uint        = nominate_num
    sql_attr_uint        = accepted_num
    sql_attr_timestamp   = vip_start_time
    sql_field_string     = nickname
    sql_field_string     = real_name
    sql_attr_uint        = focus_num
    sql_field_string     = name
    sql_attr_uint        = work_count
    sql_field_string     = identity
    sql_field_string     = signture
    sql_field_string     = avatar
    sql_attr_uint        = score
    sql_field_string     = sexstr
    sql_field_string     = residency_name
    #sql_field_string...#
    sql_ranged_throttle  = 0
}
#非企业增量数据源#
source rc_delta_not_enterprise:rc_not_enterprise
{
    sql_query_pre        = SET NAMES utf8
    sql_query_post = REPLACE INTO tb_rc_sphinx_index_tmp SELECT 2, MAX(uid) FROM keke_witkey_utf8.keke_witkey_space
    sql_query            = SELECT \
                              tem.*,\
                              (tem.focus_num + work_count) AS score,\
                              IF(\
                                LENGTH(IFNULL(tem.sex, '保密')) < 1,\
                                '保密',\
                                IFNULL(tem.sex, '保密')\
                              ) AS sexstr \
                            FROM\
                              (SELECT \
                                kws.uid,\
                                kws.username,\
                                kws.email,\
                                kws.user_pic,\
                                kws.group_id,\
                                kws.isvip,\
                                kws.status,\
                                kws.user_type,\
                                kws.sex,\
                                CRC32(kws.residency) as residency,\
                                kws.residency as residency_name,\
                                kws.birthday,\
                                kws.truename,\
                                kws.idcard,\
                                kws.idpic,\
                                kws.qq,\
                                kws.msn,\
                                kws.fax,\
                                kws.phone,\
                                kws.mobile,\
                                kws.indus_id,\
                                kws.indus_pid,\
                                kws.skill_ids,\
                                kws.summary,\
                                kws.reg_time,\
                                kws.reg_ip,\
                                kws.credit,\
                                kws.balance,\
                                kws.pub_num,\
                                kws.take_num,\
                                kws.nominate_num,\
                                kws.accepted_num,\
                                kws.vip_start_time,\
                                kws.nickname,\
                                kws.real_name AS realname,\
                                kws.focus_num,\
                                kws.username AS `name`,\
                                (SELECT \
                                  COUNT(work_id) \
                                FROM\
                                  keke_witkey_utf8.keke_works_show AS kwsh \
                                WHERE kwsh.username = kws.username AND kwsh.deleted=0) AS work_count,\
                                (SELECT \
                                  id_card \
                                FROM\
                                  vsoucenter.vso_user_auth_realname AS vuar \
                                WHERE vuar.username = kws.username) AS identity,\
                                (SELECT \
                                  IFNULL(signture, '') \
                                FROM\
                                  keke_witkey_utf8.keke_witkey_signture AS kwsi \
                                WHERE kwsi.username = kws.username) AS signture,\
                                IFNULL(\
                                  tu.avatar,\
                                  'http://www.vsochina.com//data/avatar/default/man_middle.jpg'\
                                ) AS avatar,\
                                tu.tag \
                              FROM\
                                keke_witkey_utf8.keke_witkey_space AS kws \
                                LEFT JOIN com_vsochina_maker.tb_user AS tu \
                                  ON kws.username = tu.username \
                              WHERE kws.user_type <> 2 AND kws.pre_type <> 2) AS tem \
                              WHERE uid>(SELECT max_user_id FROM com_vsochina_maker.tb_rc_sphinx_index_tmp WHERE counter_id=2 )
    sql_attr_uint        = uid
    sql_field_string     = username
    sql_field_string     = user_type
    sql_field_string     = email
    sql_field_string     = user_pic
    sql_field_string     = group_id
    sql_field_string     = isvip
    sql_attr_uint        = status
    sql_field_string     = sex
    sql_attr_uint         = residency
    sql_field_string     = birthday
    sql_field_string     = truename
    sql_field_string     = idcard
    sql_field_string     = idpic
    sql_field_string     = qq
    sql_field_string     = msn
    sql_field_string     = fax
    sql_field_string     = phone
    sql_field_string     = mobile
    sql_attr_multi        = uint indus_id from field
    sql_attr_multi        = uint indus_pid from field
    sql_field_string     = skill_ids
    sql_field_string     = summary
    sql_attr_timestamp   = reg_time
    sql_field_string     = reg_ip
    sql_attr_uint        = credit
    sql_field_string     = balance
    sql_attr_uint        = pub_num
    sql_attr_uint        = take_num
    sql_attr_uint        = nominate_num
    sql_attr_uint        = accepted_num
    sql_attr_timestamp   = vip_start_time
    sql_field_string     = nickname
    sql_field_string     = real_name
    sql_attr_uint        = focus_num
    sql_field_string     = name
    sql_attr_uint        = work_count
    sql_field_string     = identity
    sql_field_string     = signture
    sql_field_string     = avatar
    sql_attr_uint        = score
    sql_field_string     = sexstr
    sql_field_string     = residency_name
    #sql_field_string...#
    sql_ranged_throttle  = 0
}

#项目数据源#
source rc_project
{
    type                 = mysql
    sql_host             = 15.3.2.3
    sql_user             = root
    sql_pass             = dell_456
    sql_db               = com_vsochina_maker
    sql_port             = 3306
    sql_query_pre        = SET NAMES utf8
    sql_query            = SELECT * FROM tb_project WHERE proj_status = 5

    sql_attr_uint        = proj_id
    sql_field_string     = cz_proj_id
    sql_field_string     = proj_name
    sql_field_string     = proj_sub_name
    sql_field_string     = uid
    sql_field_string     = username
    sql_field_string     = proj_type
    sql_field_string     = proj_status
    sql_field_string     = proj_pct
    sql_field_string     = proj_thumb
    sql_field_string     = proj_pic
    sql_field_string     = indus_pid
    sql_field_string     = indus_name
    sql_field_string     = fans_num
    sql_field_string     = listorder
    sql_field_string     = mobile
    sql_field_string     = is_hot
    sql_field_string     = is_new
    sql_field_string     = created_at
    sql_field_string     = updated_at
    sql_field_string     = expected_period
    sql_field_string     = proj_short_desc

    #sql_field_string...#
    sql_ranged_throttle  = 0
}

#作品数据源#
source rc_works
{
    type                 = mysql
    sql_host             = 15.3.2.3
    sql_user             = root
    sql_pass             = dell_456
    sql_db               = keke_witkey_utf8
    sql_port             = 3306
    sql_query_pre        = SET NAMES utf8
    sql_query            = SELECT \
                              kws.work_id,\
                              kws.username,\
                              kws.uid,\
                              (\
                                IF(\
                                  LOCATE('http://', kws.work_url) = 0,\
                                  CONCAT(\
                                    'http://www.vsochina.com/',\
                                    kws.work_url\
                                  ),\
                                  kws.work_url\
                                )\
                              ) AS work_url,\
                              kws.work_name,\
                              kws.on_time,\
                              kws.display,\
                              kws.pic_or_video,\
                              kws.deleted,\
                              (\
                                IF(\
                                  LOCATE('http://', kws.cover_url) = 0,\
                                  CONCAT(\
                                    'http://www.vsochina.com/',\
                                    kws.cover_url\
                                  ),\
                                  kws.cover_url\
                                )\
                              ) AS cover_url,\
                              (\
                                IF(\
                                  LOCATE('http://', kws.work_link) = 0,\
                                  CONCAT(\
                                    'http://www.vsochina.com/',\
                                    kws.work_link\
                                  ),\
                                  kws.work_link\
                                )\
                              ) AS work_link,\
                              (\
                                IF(\
                                  LOCATE('http://', kws.cover_link) = 0,\
                                  CONCAT(\
                                    'http://www.vsochina.com/',\
                                    kws.cover_link\
                                  ),\
                                  kws.cover_link\
                                )\
                              ) AS cover_link,\
                              kws.description,\
                              kws.school,\
                              kws.likenum,\
                              kws.sharenum,\
                              kws.browsenum,\
                              kws.commentnum,\
                              kws.prizeflag,\
                              kws.wd_privacy,\
                              kws.wd_price_end,\
                              kws.wd_price_start,\
                              kws.wd_period_start,\
                              kws.wd_period_end,\
                              kws.activity,\
                              kws.p_work_id,\
                              kws.worktext,\
                              kws.alt,\
                              (SELECT \
                                COUNT(work_id) \
                              FROM\
                                keke_witkey_utf8.keke_works_show \
                              WHERE username = kws.username \
                                AND deleted = 0) AS work_count \
                            FROM\
                              keke_witkey_utf8.keke_works_show AS kws \
                            WHERE deleted = 0

    #sql_attr_uint        = work_id
    sql_field_string     = work_id
    sql_field_string     = username
    sql_attr_uint        = uid
    sql_field_string     = work_url
    sql_field_string     = work_name
    sql_field_string     = on_time
    sql_field_string     = display
    sql_field_string     = pic_or_video
    sql_field_string     = cover_url
    sql_field_string     = work_link
    sql_field_string     = cover_link
    sql_field_string     = description
    sql_field_string     = school
    sql_attr_uint        = likenum		#修改为uint属性,方便按照点赞数量牌序
    sql_field_string     = sharenum
    sql_field_string     = browsenum
    sql_field_string     = commentnum
    sql_field_string     = prizeflag
    sql_field_string     = wd_privacy
    sql_field_string     = wd_price_end
    sql_field_string     = wd_price_start
    sql_field_string     = wd_period_start
    sql_field_string     = wd_period_end
    sql_field_string     = activity
    sql_field_string     = p_work_id
    sql_field_string     = worktext
    sql_field_string     = alt
    sql_attr_uint        = work_count

    #sql_field_string...#
    sql_ranged_throttle  = 0
}


#任务数据源#
source vso_task
{
    type                 = mysql
    sql_host             = 15.3.2.3
    sql_user             = root
    sql_pass             = dell_456
    sql_db               = keke_witkey_utf8
    sql_port             = 3306
    sql_query_pre        = SET NAMES utf8
    sql_query            = SELECT \
                              tmiw.*,\
                              fil.file_count AS participant_num \
                            FROM\
                              (SELECT \
                                tami.*,\
                                wor.username AS winner \
                              FROM\
                                (SELECT \
                                  taml.*,\
                                  indus.indus_name \
                                FROM\
                                  (SELECT \
                                    task.*,\
                                    model.model_name \
                                  FROM\
                                    keke_witkey_utf8.keke_witkey_task AS task \
                                    LEFT JOIN keke_witkey_utf8.keke_witkey_model AS model \
                                      ON task.model_id = model.model_id \
                                  WHERE task.model_id = 1 \
                                    OR task.model_id = 12) AS taml \
                                  LEFT JOIN keke_witkey_utf8.keke_witkey_industry AS indus \
                                    ON taml.indus_id = indus.indus_id \
                                    OR taml.indus_pid = indus.indus_id) AS tami \
                                LEFT JOIN \
                                  (SELECT \
                                    * \
                                  FROM\
                                    keke_witkey_utf8.keke_witkey_task_work \
                                  WHERE work_status = 4) AS wor \
                                  ON tami.task_id = wor.task_id \
                                  AND tami.username <> wor.username \
                              GROUP BY tami.task_id) AS tmiw \
                              LEFT JOIN \
                                (SELECT \
                                  task_id,\
                                  COUNT(username) AS file_count \
                                FROM\
                                  keke_witkey_utf8.keke_witkey_task_file \
                                GROUP BY task_id) AS fil \
                                ON tmiw.task_id = fil.task_id

    sql_attr_uint        = task_id
    sql_attr_uint        = model_id
    sql_attr_uint        = work_count
    sql_field_string     = single_cash
    sql_field_string     = profit_rate
    sql_field_string     = task_fail_rate
    sql_attr_uint        = task_status
    sql_field_string     = task_title
    sql_field_string     = task_desc
    sql_field_string     = task_file
    sql_field_string     = task_pic
    sql_attr_uint        = indus_id
    sql_attr_uint        = indus_pid
    sql_field_string     = uid
    sql_field_string     = username
    sql_attr_uint        = start_time
    sql_attr_uint        = sub_time
    sql_attr_uint        = end_time
    sql_attr_uint        = sp_end_time
    sql_field_string     = city
    sql_attr_uint        = task_cash
    sql_attr_uint        = real_cash
    sql_field_string     = task_cash_coverage
    sql_attr_uint        = cash_cost
    sql_attr_uint        = credit_cost
    sql_attr_uint        = view_num
    sql_attr_uint        = work_num
    sql_attr_uint        = leave_num
    sql_attr_uint        = focus_num
    sql_attr_uint        = mark_num
    sql_field_string     = is_delineas
    sql_field_string     = kf_uid
    sql_field_string     = pay_item
    sql_field_string     = att_cash
    sql_field_string     = contact
    sql_field_string     = unique_num
    sql_field_string     = ext_desc
    sql_field_string     = task_union
    sql_field_string     = alipay_trust
    sql_field_string     = is_delay
    sql_field_string     = r_task_id
    sql_field_string     = is_trust
    sql_field_string     = trust_type
    sql_field_string     = is_top
    sql_field_string     = is_auto_bid
    sql_field_string     = point
    sql_field_string     = payitem_time
    sql_field_string     = end_action
    sql_field_string     = task_fail_rate_more_than_20
    sql_field_string     = sms_status
    sql_field_string     = creation_unm
    sql_field_string     = feedback_unm
    sql_field_string     = mobile
    sql_field_string     = email
    sql_field_string     = qq
    sql_field_string     = linkman
    sql_field_string     = sex
    sql_field_string     = is_hide
    sql_field_string     = mark
    sql_field_string     = bid_uid
    sql_field_string     = bid_username
    sql_field_string     = bid_task_id
    sql_field_string     = bid_modify_num
    sql_field_string     = msg_status
    sql_field_string     = telephone
    sql_field_string     = service_charge
    #sql_field_string     = use_vso_online
    sql_field_string     = sitedomain
    sql_field_string     = cash_timeline
    sql_field_string     = examine_time
    sql_field_string     = model_name
    sql_field_string     = indus_name
    #sql_field_string     = indus_pname
    sql_attr_uint        = participant_num
    sql_field_string     = winner



    #sql_field_string...#
    sql_ranged_throttle  = 0
}


#收藏数据源#
source vso_favorite
{
    type                 = mysql
    sql_host             = 192.168.2.27
    sql_user             = root
    sql_pass             = dell_456
    sql_db               = keke_witkey_utf8
    sql_port             = 3306
    sql_query_pre        = SET NAMES utf8
    sql_query            = SELECT * FROM keke_witkey_utf8.keke_witkey_favorite

    sql_attr_uint        = f_id
    sql_field_string     = keep_type
    sql_field_string     = obj_type
    sql_field_string     = origin_id
    sql_field_string     = obj_id
    sql_field_string     = obj_name
    sql_field_string     = uid
    sql_field_string     = username
    sql_attr_timestamp   = on_date
    sql_field_string     = page_size
    sql_field_string     = page


    #sql_field_string...#
    sql_ranged_throttle  = 0
}

#投标数据源#
source vso_bid
{
    type                 = mysql
    sql_host             = 192.168.2.27
    sql_user             = root
    sql_pass             = dell_456
    sql_db               = keke_witkey_utf8
    sql_port             = 3306
    sql_query_pre        = SET NAMES utf8
    sql_query            = SELECT *,sign_time AS start_time FROM keke_witkey_utf8.keke_witkey_task_bid

    sql_attr_uint        = bid_id
    sql_field_string     = task_id
    sql_field_string     = uid
    sql_field_string     = username
    sql_field_string     = quote
    sql_attr_uint        = cycle
    sql_field_string     = area
    sql_field_string     = message
    sql_attr_uint        = bid_status
    sql_attr_timestamp   = bid_time
    sql_attr_uint        = hidden_status
    sql_attr_uint        = ext_status
    sql_attr_uint        = comment_num
    sql_field_string     = mobile
    sql_attr_timestamp   = sign_time
    sql_attr_uint        = start_time


    #sql_field_string...#
    sql_ranged_throttle  = 0
}

#接任务数据源#
source task_undertaker
{
    type                 = mysql
    sql_host             = 192.168.2.27
    sql_user             = root
    sql_pass             = dell_456
    sql_db               = keke_witkey_utf8
    sql_port             = 3306
    sql_query_pre        = SET NAMES utf8
    sql_query            = SELECT kwtf.*,kwtw.work_status FROM keke_witkey_utf8.keke_witkey_task_file AS kwtf INNER JOIN keke_witkey_utf8.keke_witkey_task_work AS kwtw ON kwtf.task_id = kwtw.task_id

    sql_attr_uint        = id
    sql_field_string     = uid
    sql_field_string     = username
    sql_field_string     = task_id
    sql_field_string     = task_title
    sql_field_string     = comment_id
    sql_attr_timestamp   = on_time
    sql_field_string     = modify_name
    sql_attr_timestamp   = modify_time
    sql_field_string     = complete_status
    sql_attr_uint        = modify_id
    sql_attr_uint        = work_status

    #sql_field_string...#
    sql_ranged_throttle  = 0
}

#稿件数据源#
source task_draft
{
    type                 = mysql
    sql_host             = 192.168.2.27
    sql_user             = root
    sql_pass             = dell_456
    sql_db               = keke_witkey_utf8
    sql_port             = 3306
    sql_query_pre        = SET NAMES utf8
    sql_query            = SELECT \
                              kwtw.*,kwf.save_name \
                            FROM\
                              keke_witkey_utf8.keke_witkey_task_work AS kwtw \
                              INNER JOIN keke_witkey_utf8.keke_witkey_file AS kwf \
                                ON kwtw.task_id = kwf.task_id\
                                AND kwtw.username = kwf.username

    sql_attr_uint        = work_id
    sql_attr_uint        = task_id
    sql_attr_uint        = uid
    sql_field_string     = username
    sql_field_string     = work_title
    sql_field_string     = work_prise
    sql_field_string     = work_desc
    sql_field_string     = work_file
    sql_field_string     = work_pic
    sql_attr_timestamp   = work_time
    sql_field_string     = hide_work
    sql_attr_uint        = vote_num
    sql_attr_uint        = comment_num
    sql_attr_uint        = work_status
    sql_field_string     = mobile
    sql_field_string     = view_status
    sql_field_string     = msg
    sql_field_string     = save_name


    #sql_field_string...#
    sql_ranged_throttle  = 0
}

#############################################################################
## 索引配置
#############################################################################
#企业人才索引#
index enterprise
{
    source            = rc_enterprise
    path              = /app/sphinx/var/data/enterprise
    docinfo           = extern
    mlock             = 0
    morphology        = none
    min_word_len      = 1
    charset_dictpath  = /app/mmseg/etc
    charset_type      = zh_cn.utf-8
    ngram_len         = 0
    min_infix_len     = 1
}
#企业人才增量索引#
index delta_enterprise:enterprise
{
    source            = rc_delta_enterprise
    path              = /app/sphinx/var/data/delta_enterprise
    docinfo           = extern
    mlock             = 0
    morphology        = none
    min_word_len      = 1
    charset_dictpath  = /app/mmseg/etc
    charset_type      = zh_cn.utf-8
    ngram_len         = 0
    min_infix_len     = 1
}
#非企业人才索引#
index talent
{
    source            = rc_not_enterprise
    path              = /app/sphinx/var/data/talent
    docinfo           = extern
    mlock             = 0
    morphology        = none
    min_word_len      = 1
    charset_dictpath  = /app/mmseg/etc
    charset_type      = zh_cn.utf-8
    ngram_len         = 0
    min_infix_len     = 1
}
#非企业人才增量索引#
index delta_talent:talent
{
    source            = rc_delta_not_enterprise
    path              = /app/sphinx/var/data/delta_talent
    docinfo           = extern
    mlock             = 0
    morphology        = none
    min_word_len      = 1
    charset_dictpath  = /app/mmseg/etc
    charset_type      = zh_cn.utf-8
    ngram_len         = 0
    min_infix_len     = 1
}
#项目索引#
index project
{
    source            = rc_project
    path              = /app/sphinx/var/data/project
    docinfo           = extern
    mlock             = 0
    morphology        = none
    min_word_len      = 1
    charset_dictpath  = /app/mmseg/etc
    charset_type      = zh_cn.utf-8
    ngram_len         = 0
    min_infix_len     = 1
}

#作品索引#
index work
{
    source            = rc_works
    path              = /app/sphinx/var/data/work
    docinfo           = extern
    mlock             = 0
    morphology        = none
    min_word_len      = 1
    charset_dictpath  = /app/mmseg/etc
    charset_type      = zh_cn.utf-8
    ngram_len         = 0
    min_infix_len     = 1
}
#
#任务索引#
#index task
#{
#    source            = vso_task
#    path              = /app/sphinx/var/data/task
#    docinfo           = extern
#    mlock             = 0
#    morphology        = none
#    min_word_len      = 1
#    charset_dictpath  = /app/mmseg/etc
#    charset_type      = zh_cn.utf-8
#    ngram_len         = 0
#}
#
##收藏索引#
#index favorite
#{
#    source            = vso_favorite
#    path              = /app/sphinx/var/data/favorite
#    docinfo           = extern
#    mlock             = 0
#    morphology        = none
#    min_word_len      = 1
#    charset_dictpath  = /app/mmseg/etc
#    charset_type      = zh_cn.utf-8
#    ngram_len         = 0
#}
#
##投标索引#
#index bid
#{
#    source            = vso_bid
#    path              = /app/sphinx/var/data/bid
#    docinfo           = extern
#    mlock             = 0
#    morphology        = none
#    min_word_len      = 1
#    charset_dictpath  = /app/mmseg/etc
#    charset_type      = zh_cn.utf-8
#    ngram_len         = 0
#}
#
##承接任务索引#
#index undertaker
#{
#    source            = task_undertaker
#    path              = /app/sphinx/var/data/undertaker
#    docinfo           = extern
#    mlock             = 0
#    morphology        = none
#    min_word_len      = 1
#    charset_dictpath  = /app/mmseg/etc
#    charset_type      = zh_cn.utf-8
#    ngram_len         = 0
#}
#
##稿件索引#
#index draft
#{
#    source            = task_draft
#    path              = /app/coreseek/var/data/draft
#    docinfo           = extern
#    mlock             = 0
#    morphology        = none
#    min_word_len      = 1
#    charset_dictpath  = /app/mmseg/etc
#    charset_type      = zh_cn.utf-8
#    ngram_len         = 0
#}

#############################################################################
## 索引参数设置
#############################################################################

indexer
{
    mem_limit         = 256M
}

#############################################################################
## 查询服务设置
#############################################################################

searchd
{
    listen            = 9312
    log               = /app/sphinx/var/log/searchd.log
    query_log         = /app/sphinx/var/log/query.log
    read_timeout      = 5
    client_timeout    = 300
    max_children      = 30
    pid_file          = /app/sphinx/var/log/searchd.pid
    max_matches       = 15000
    seamless_rotate   = 1
    preopen_indexes   = 1
    unlink_old        = 1
    mva_updates_pool  = 1M
    max_packet_size   = 8M
    max_filters       = 256
    max_filter_values = 4096
    max_batch_queries = 32
    workers           = threads
}